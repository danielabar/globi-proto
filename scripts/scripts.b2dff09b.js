"use strict";angular.module("globiProtoApp",["ngAnimate","ngAria","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.select"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("globiProtoApp").controller("MainCtrl",["$scope","closeMatch","images","$rootScope","interactionTypes","taxonInteraction",function(a,b,c,d,e,f){a.query={},a.taxon={},a.interactions=[],a.searchResults=[],e.get().$promise.then(function(b){Object.keys(b).forEach(function(c){c.match(/^\$/)||a.interactions.push({name:c,source:b[c].source,target:b[c].target})})}),a.getResults=function(a){return b.get({taxon:a}).$promise.then(function(a){return a.data.map(function(a){return a[0]})})},a.taxonSelected=function(b){c.get({taxon:b}).$promise.then(function(b){a.taxon={scientificName:b.scientificName,commonName:b.commonName,thumbnailURL:b.thumbnailURL,imageURL:b.imageURL,infoURL:b.infoURL},d.$emit("taxonEvent",a.taxon),d.$broadcast("taxonEvent",a.taxon)},function(b){console.dir(b),a.taxon={},d.$emit("taxonEvent",a.taxon),d.$broadcast("taxonEvent",a.taxon)})},a.search=function(){a.searchResults=[],f.get({taxon:a.query.name,interaction:a.query.interaction}).$promise.then(function(b){var e=b.data[0][2];console.dir(e),e.forEach(function(b){c.get({taxon:b}).$promise.then(function(b){a.searchResults.push({scientificName:b.scientificName,commonName:b.commonName,thumbnailURL:b.thumbnailURL,imageURL:b.imageURL,infoURL:b.infoURL}),d.$emit("taxonEvent",a.searchResults[a.searchResults.length-1]),d.$broadcast("taxonEvent",a.searchResults[a.searchResults.length-1])},function(a){console.dir(a)})})},function(a){console.dir(a)})}}]),angular.module("globiProtoApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("globiProtoApp").factory("closeMatch",["$resource","apiUrl",function(a,b){return a(b+"/findCloseMatchesForTaxon/:taxon",{taxon:"@taxon"})}]),angular.module("globiProtoApp").value("apiUrl","http://api.globalbioticinteractions.org"),angular.module("globiProtoApp").factory("images",["$resource","apiUrl",function(a,b){return a(b+"/imagesForName/:taxon",{taxon:"@taxon"})}]),angular.module("globiProtoApp").directive("backgroundImage",["$rootScope",function(a){return{restrict:"A",link:function(b,c){var d="http://dummyimage.com/150x150&text=No%20image%20available";b.$on("taxonEvent",function(a,b){console.log("=== IMAGE BACKGROUND RESPONDING TO $scope.$on TAXON EVENT: "+JSON.stringify(b)),b.thumbnailURL?c.css("background-image","url("+b.thumbnailURL+")"):c.css("background-image","url("+d+")")}),a.$on("taxonEvent",function(a,b){console.log("=== IMAGE BACKGROUND RESPONDING TO $rootScope.$on TAXON EVENT: "+JSON.stringify(b)),b.thumbnailURL?c.css("background-image","url("+b.thumbnailURL+")"):c.css("background-image","url("+d+")")})}}}]),angular.module("globiProtoApp").directive("imageTile",function(){return{restrict:"A",replace:!0,scope:{imageData:"=imageTile"},templateUrl:"views/imageTile.html",controller:"ImagetileCtrl"}}),angular.module("globiProtoApp").controller("ImagetileCtrl",["$scope",function(a){a.foo="foo"}]),angular.module("globiProtoApp").factory("interactionTypes",["$resource","apiUrl",function(a,b){return a(b+"/interactionTypes")}]),angular.module("globiProtoApp").factory("taxonInteraction",["$resource","apiUrl",function(a,b){return a(b+"/taxon/:taxon/:interaction",{taxon:"@taxon",interaction:"@interaction"})}]);